(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var i in a)e.o(a,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:a[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,a=window.wp.plugins,i=window.wp.editPost,n=window.wp.components,l=window.wp.element,s=window.wp.i18n,r=window.wp.apiFetch;var o=e.n(r);const c=window.wp.data;(0,a.registerPlugin)("geoai-sidebar",{render:()=>{const[e,a]=(0,l.useState)(!1),[r,d]=(0,l.useState)(null),[m,g]=(0,l.useState)(null),u=(0,c.useSelect)(e=>e("core/editor").getCurrentPostId(),[]),p=r?.suggestions?.titleOptions&&r.suggestions.titleOptions.length>0,E=r?.suggestions?.entities&&r.suggestions.entities.length>0,y=r?.suggestions?.citations&&r.suggestions.citations.length>0;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(i.PluginSidebarMoreMenuItem,{target:"geoai-sidebar"},(0,s.__)("GEO AI","geo-ai")),(0,t.createElement)(i.PluginSidebar,{name:"geoai-sidebar",title:(0,s.__)("GEO AI Audit","geo-ai")},(0,t.createElement)(n.PanelBody,null,(0,t.createElement)(n.Button,{isPrimary:!0,onClick:async()=>{a(!0),g(null);try{const e=await o()({path:"/geoai/v1/audit",method:"POST",data:{post_id:u}});e.success?d(e.data):g(e.message||(0,s.__)("Audit failed","geo-ai"))}catch(e){g(e.message||(0,s.__)("An error occurred","geo-ai"))}finally{a(!1)}},disabled:e,style:{width:"100%",marginBottom:"16px"}},e?(0,t.createElement)(n.Spinner,null):(0,s.__)("Run AI Audit","geo-ai")),m&&(0,t.createElement)(n.Notice,{status:"error",isDismissible:!1},m),r&&(0,t.createElement)("div",{className:"geoai-audit-results"},(0,t.createElement)("div",{className:"geoai-score-dial",style:{textAlign:"center",padding:"20px",marginBottom:"16px"}},(0,t.createElement)("div",{style:{fontSize:"48px",fontWeight:"bold",color:(_=r.scores.total,_>=80?"#46b450":_>=60?"#ffb900":"#dc3232")}},r.scores.total),(0,t.createElement)("div",{style:{fontSize:"14px",color:"#666"}},(0,s.__)("Overall Score","geo-ai"))),(0,t.createElement)("div",{style:{marginBottom:"16px"}},(0,t.createElement)("strong",null,(0,s.__)("Score Breakdown:","geo-ai")),(0,t.createElement)("ul",{style:{listStyle:"none",padding:0}},(0,t.createElement)("li",null,(0,s.__)("Answerability:","geo-ai")," ",r.scores.answerability),(0,t.createElement)("li",null,(0,s.__)("Structure:","geo-ai")," ",r.scores.structure),(0,t.createElement)("li",null,(0,s.__)("Trust:","geo-ai")," ",r.scores.trust),(0,t.createElement)("li",null,(0,s.__)("Technical:","geo-ai")," ",r.scores.technical))),r.issues&&r.issues.length>0&&(0,t.createElement)("div",null,(0,t.createElement)("strong",null,(0,s.__)("Issues:","geo-ai")),(0,t.createElement)("ul",{style:{listStyle:"none",padding:0}},r.issues.map((e,a)=>(0,t.createElement)("li",{key:a,style:{marginBottom:"12px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}},(0,t.createElement)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"}},(0,t.createElement)("span",{style:{color:"high"===e.severity?"#dc3232":"med"===e.severity?"#ffb900":"#46b450",fontWeight:"bold"}},e.severity.toUpperCase())),(0,t.createElement)("div",null,e.msg),e.quickFix&&(0,t.createElement)(n.Button,{isSmall:!0,isSecondary:!0,onClick:()=>(async e=>{try{await o()({path:"/geoai/v1/quick-fix",method:"POST",data:{post_id:u,fix_id:e}}),window.location.reload()}catch(e){g(e.message)}})(e.quickFix),style:{marginTop:"8px"}},(0,s.__)("Apply Quick Fix","geo-ai")))))),(p||E||y)&&(0,t.createElement)("div",{style:{marginTop:"16px"}},(0,t.createElement)("strong",null,(0,s.__)("AI Suggestions","geo-ai")),p&&(0,t.createElement)("div",{style:{marginTop:"12px"}},(0,t.createElement)("div",{style:{fontWeight:"600",marginBottom:"4px"}},(0,s.__)("Meta Title Ideas","geo-ai")),(0,t.createElement)("ul",{style:{listStyle:"disc",paddingLeft:"20px",margin:0}},r.suggestions.titleOptions.map((e,a)=>(0,t.createElement)("li",{key:`title-${a}`},e)))),E&&(0,t.createElement)("div",{style:{marginTop:"12px"}},(0,t.createElement)("div",{style:{fontWeight:"600",marginBottom:"4px"}},(0,s.__)("Relevant Entities","geo-ai")),(0,t.createElement)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"}},r.suggestions.entities.map((e,a)=>(0,t.createElement)("span",{key:`entity-${a}`,style:{background:"#f0f0f0",borderRadius:"12px",padding:"4px 10px",fontSize:"12px"}},e)))),y&&(0,t.createElement)("div",{style:{marginTop:"12px"}},(0,t.createElement)("div",{style:{fontWeight:"600",marginBottom:"4px"}},(0,s.__)("Suggested Citations","geo-ai")),(0,t.createElement)("ul",{style:{listStyle:"disc",paddingLeft:"20px",margin:0}},r.suggestions.citations.map((e,a)=>(0,t.createElement)("li",{key:`citation-${a}`},(0,t.createElement)("a",{href:e,target:"_blank",rel:"noreferrer"},e))))))))));var _},icon:"search"});const d=window.wp.blocks,m=window.wp.blockEditor,g=JSON.parse('{"UU":"geoai/answer-card"}');(0,d.registerBlockType)(g.UU,{edit:function({attributes:e,setAttributes:a}){const{tldr:i,keyFacts:l}=e;return(0,t.createElement)("div",{...(0,m.useBlockProps)()},(0,t.createElement)("div",{className:"geoai-answer-card geoai-answer-card-editor"},(0,t.createElement)("div",{className:"geoai-answer-card-header"},(0,t.createElement)("h3",null,(0,s.__)("TL;DR","geo-ai"))),(0,t.createElement)("div",{className:"geoai-answer-card-body"},(0,t.createElement)(m.RichText,{tagName:"p",value:i,onChange:e=>a({tldr:e}),placeholder:(0,s.__)("Enter a concise summary (max 200 words)...","geo-ai"),className:"geoai-answer-card-tldr"}),(0,t.createElement)("div",{className:"geoai-answer-card-facts"},(0,t.createElement)("h4",null,(0,s.__)("Key Facts","geo-ai")),(0,t.createElement)("ul",null,l.map((e,i)=>(0,t.createElement)("li",{key:i},(0,t.createElement)(m.RichText,{tagName:"span",value:e,onChange:e=>((e,t)=>{const i=[...l];i[e]=t,a({keyFacts:i})})(i,e),placeholder:(0,s.__)("Enter key fact...","geo-ai")}),(0,t.createElement)(n.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(e=>{const t=l.filter((t,a)=>a!==e);a({keyFacts:t})})(i)},(0,s.__)("Remove","geo-ai"))))),(0,t.createElement)(n.Button,{isPrimary:!0,isSmall:!0,onClick:()=>{a({keyFacts:[...l,""]})}},(0,s.__)("Add Key Fact","geo-ai"))))))},save:function({attributes:e}){const{tldr:a,keyFacts:i}=e;return(0,t.createElement)("div",{...m.useBlockProps.save()},(0,t.createElement)("div",{className:"geoai-answer-card"},(0,t.createElement)("div",{className:"geoai-answer-card-header"},(0,t.createElement)("h3",null,(0,s.__)("TL;DR","geo-ai"))),(0,t.createElement)("div",{className:"geoai-answer-card-body"},(0,t.createElement)(m.RichText.Content,{tagName:"p",value:a,className:"geoai-answer-card-tldr"}),i&&i.length>0&&(0,t.createElement)("div",{className:"geoai-answer-card-facts"},(0,t.createElement)("h4",null,(0,s.__)("Key Facts","geo-ai")),(0,t.createElement)("ul",null,i.map((e,a)=>(0,t.createElement)("li",{key:a},(0,t.createElement)(m.RichText.Content,{tagName:"span",value:e}))))))))},title:(0,s.__)("Answer Card","geo-ai"),description:(0,s.__)("A concise TL;DR summary with key facts optimized for AI answer engines.","geo-ai"),icon:"info"})})();